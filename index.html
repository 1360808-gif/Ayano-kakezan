<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ã‹ã‘ç®—ï¼ˆ3å¹´ç”Ÿï¼‰</title>

<!-- â˜… CSS ã¯å…ƒã‚³ãƒ¼ãƒ‰ãã®ã¾ã¾ï¼ˆçœç•¥ã›ãšä½¿ã£ã¦OKï¼‰ -->
<!-- ã“ã“ã§ã¯ä¸­èº«ã¯ä¸€åˆ‡å¤‰æ›´ã—ã¦ã„ã¾ã›ã‚“ -->
<style>
/* ï¼ï¼ï¼ ã“ã“ã¯è³ªå•æ–‡ã®CSSã¨å®Œå…¨åŒä¸€ãªã®ã§çœç•¥ã›ãšä½¿ã£ã¦ãã ã•ã„ ï¼ï¼ï¼ */
</style>
</head>

<body>
<div class="wrap">
  <div class="layout">

    <div class="leftCol">
      <div class="top">

        <div class="titleRow">
          <h1>ã‹ã‘ç®—ï¼ˆ3å¹´ç”Ÿï¼‰</h1>

          <div class="bestBox" id="bestInline">
            <button id="clearBestBtn" class="bestClearBtn" type="button">ğŸ—‘</button>
            <span class="label">ğŸ† ãƒ™ã‚¹ãƒˆ</span>
            <span class="value" id="bestText">â€”</span>
            <span class="label">ã³ã‚‡ã†</span>
          </div>
        </div>

        <div class="controlsRow">
          <div class="controlsLeft">
            <button class="primary" id="checkBtn">ã“ãŸãˆã‚ã‚ã›</button>
          </div>

          <div class="timerInline" id="timerInline">
            <div class="timer" id="timerBox">
              <span class="label">â± ã‚¿ã‚¤ãƒ </span>
              <span class="value" id="timerText">0.0</span>
              <span class="label">ã³ã‚‡ã†</span>
            </div>
            <div class="hint" id="timerHint">ã€Œã‚‚ã‚“ã ã„ã‚’ã¤ãã‚‹ã€ã§ã‚¹ã‚¿ãƒ¼ãƒˆ</div>
          </div>

          <div class="controlsRight">
            <label class="switch">
              <input type="checkbox" id="timingToggle" checked>
              ã‚¿ã‚¤ãƒ 
            </label>
            <button id="makeBtn">ã‚‚ã‚“ã ã„ã‚’ã¤ãã‚‹</button>
          </div>
        </div>
      </div>

      <div class="panel" style="margin-top:12px;">
        <div class="grid" id="qs"></div>
        <div class="score" id="score">ç‚¹æ•°ï¼šâ€” / 100</div>
      </div>
    </div>

    <!-- æ‰‹æ›¸ãã‚¹ãƒšãƒ¼ã‚¹ï¼ˆãã®ã¾ã¾ï¼‰ -->
    <div class="panel">
      <div class="boardHeader">
        <div class="boardTitle">âœ æ‰‹æ›¸ãè¨ˆç®—ã‚¹ãƒšãƒ¼ã‚¹</div>
        <div class="boardTools">
          <button class="toolBtn active" id="penBtn">ãƒšãƒ³</button>
          <button class="toolBtn" id="eraserBtn">æ¶ˆã—ã‚´ãƒ </button>
          <button class="toolBtn" id="clearBtn">ãœã‚“ã¶ã‘ã™</button>
        </div>
      </div>

      <div class="canvasWrap">
        <canvas id="board"></canvas>
      </div>
    </div>

  </div>
</div>

<script>
function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}

let problems=[];
const QNUM=10;

/* ===== ã‹ã‘ç®—ã®å•é¡Œã‚’ä½œã‚‹ ===== */
function makeProblems(){
  const out=[];
  while(out.length<QNUM){
    const a = rand(2,9);
    const b = rand(2,9);
    out.push({a,b,ans:a*b});
  }
  return out;
}

/* ===== è¡¨ç¤º ===== */
function render(){
  const qs=document.getElementById("qs");
  qs.innerHTML="";

  problems.forEach((p)=>{
    const d=document.createElement("div");
    d.className="q";
    d.innerHTML=`
      <div class="qRow">
        <div class="qInline">
          <span class="expr">${p.a} Ã— ${p.b} ï¼</span>
          <span class="answerBox">
            <input class="ans" inputmode="numeric">
            <span class="mark"></span>
          </span>
        </div>
      </div>
    `;
    qs.appendChild(d);
  });

  document.getElementById("score").textContent="ç‚¹æ•°ï¼šâ€” / 100";
}

/* ===== æ­£èª¤åˆ¤å®š ===== */
function check(){
  let score=0;
  document.querySelectorAll(".q").forEach((card,i)=>{
    const box=card.querySelector(".answerBox");
    box.classList.remove("ok");

    const v=Number(card.querySelector(".ans").value);
    if(v===problems[i].ans){
      box.classList.add("ok");
      score+=10;
    }
  });
  document.getElementById("score").textContent=`ç‚¹æ•°ï¼š${score} / 100`;
}

/* ===== åˆæœŸåŒ– ===== */
document.getElementById("makeBtn").onclick=()=>{
  problems=makeProblems();
  render();
};
document.getElementById("checkBtn").onclick=check;

problems=makeProblems();
render();
</script>
</body>
</html>
